#  R-tree: 空間探索のための動的インデックス構造

##  基本定義

**R-tree（Rectangle tree / Region tree）** は、  
Antonin Guttman により 1984 年に提案された **空間データ専用の動的インデックス構造** です。  
地理情報（GIS）、CAD、画像・映像解析など、  
**多次元座標を持つデータ**を効率的に格納・検索するために設計されました。

各データオブジェクトは「点」ではなく**領域（矩形）**として表され、  
それらの最小外接矩形（MBR: Minimum Bounding Rectangle）を階層的にまとめることで、  
空間全体を再帰的に分割・管理します。

---

##  検索における役割と効果

R-tree は、検索範囲と重ならないノードをスキップできるため、  
空間探索の際に **不要な探索領域を剪定（prune）** することが可能です。  

代表的な検索操作：

- **範囲検索（Range Query）**：  
  指定領域と重なるすべてのオブジェクトを取得。
- **包含検索（Containment Query）**：  
  指定領域内に完全に含まれるオブジェクトを取得。
- **近傍検索（Nearest Neighbor Query）**：  
  ある点から最も近いオブジェクトを探索。

従来の木構造では「等価比較」「大小比較」のみを利用しますが、  
R-tree では「**幾何的重なり（Overlap）**」を利用して検索空間を動的に制限します。  
これにより、多次元空間でも効率的な探索が可能になります。

---

##  R-tree と従来の木構造の本質的な違い

| 観点               | 従来の木構造（例：二分木、B木、Trie など） | R-tree                                       |
| ------------------ | ------------------------------------------ | -------------------------------------------- |
| **データの性質**   | 1次元キー（数値・文字列）                  | 多次元領域（矩形・多角形など）               |
| **キーの順序性**   | 線形（大小比較で順序づけ可能）             | 非線形（空間的な重なりや包含）               |
| **ノード内の境界** | 境界は「値の範囲」で一意に決まる           | 範囲が重なり合う（非排他的）                 |
| **検索基準**       | 値の大小・一致                             | 空間的関係（重なり・距離・包含）             |
| **枝の選択方法**   | 1本のみ（決定的経路）                      | 複数の枝を同時に探索（非決定的経路）         |
| **構造の性質**     | 厳密な順序構造・分岐バランス               | 領域の被覆関係による階層構造                 |
| **更新時の再構築** | ノード分割は値範囲に基づく                 | 領域の重なりを最小化するよう動的分割         |
| **想定する応用**   | データベースの索引、辞書検索               | 空間検索（GIS、画像、CAD、ロボティクスなど） |

---

##  概念的まとめ

- 従来の木構造は「**1次元の順序空間**」を効率化するために作られた。  
  例：二分探索木・B木・AVL木などはすべて「値の並び順」に基づく構造。
- R-tree は「**n次元の空間構造**」を扱うために設計された。  
  そのため、ノード同士の関係は「大きい／小さい」ではなく「重なる／含まれる」で定義される。
- 検索は **単一路径ではなく複数経路の並列探索** になる。  
  → 空間的な曖昧性（overlap）を許容する設計。
- ノード分割も「領域の重なりを最小化するように」設計され、  
  動的に形状が調整される（B木のような固定境界ではない）。

---

## 参考文献
Antonin Guttman,  
**"R-Trees: A Dynamic Index Structure for Spatial Searching"**,  
*Proceedings of the ACM SIGMOD Conference*, 1984.:contentReference[oaicite:0]{index=0}

---