# Misra-Griesアルゴリズム（v3.1 / v3.2 / v3.3）

## 1. このアルゴリズムはどのようなデータに対して、どのような操作をするアルゴリズムか

Misra-Griesアルゴリズムは、大量のストリームデータ（例：ログ、センサーデータ、ネットワークトラフィックなど）に対して、**出現頻度が全体のN/kを超える可能性のある要素を検出する**ための、空間効率の高いアルゴリズムです。

- 通常、全データを記録・集計するとO(N)の空間が必要ですが、Misra-Griesは**O(k)** の空間だけでこれを近似的に実現できます。
- 出力される候補集合の中には実際にN/k以上出現していない要素も含まれますが、**本当にN/k以上の要素は必ず候補集合に含まれます**。
- 頻出要素の「検出」には有効ですが、「正確な頻度推定」には向きません。

---

## 2. アルゴリズムのバージョンごとの動作と例

### ✅ v3.1：Algorithm 3.1（全体-1カウント法）

#### ● 処理手順：
1. 要素が候補集合にある → カウントを+1  
2. 候補がk-1未満 → 追加（カウント1）  
3. 候補がk-1に達している → 全候補のカウントを-1し、0になったものは削除  

#### ● 入力例：
```python
data = [1, 2, 1, 3, 1, 2, 1, 4, 5, 1]
k = 3
```
#### ● 処理結果：
```python
{1: 3, 5: 1}
```

#### ● 特徴：
- 各データ到着時に全体操作（-1）が発生するため、効率はやや低い。
- 高頻度要素も誤って削除される可能性がある。

---

### ✅ v3.2：Algorithm 3.2（Δを使った段階的削除）

#### ● 処理手順：
1. 各データ到着時に `n` を+1し、Δ = ⌊n/k⌋ を再計算  
2. 新しい要素を追加する際、カウントは `Δ + 1`  
3. Δが更新されたタイミングで、候補の中で `count < Δ` のものを削除  

#### ● 入力例：
```python
data = [1, 2, 1, 3, 1, 2, 1, 4, 5, 1, 6, 2, 7, 1, 8, 9, 1, 1, 1, 1]
k = 5
```
#### ● 処理結果：
```python
{1: 10, 9: 4}
```

#### ● 特徴：
- v3.1のような毎回の全体-1操作が不要で高速。
- Δによって削除タイミングをコントロールできる。
- 頻度の推定値が実際より高くなる（初期値がΔ+1なのでバイアスがかかる）。

---

### ✅ v3.3：Algorithm 3.3（最小要素置換法）

#### ● 処理手順：
1. 要素が候補にある → +1  
2. 候補がk未満 → 1で追加  
3. 候補がkに達している → 最小カウントの要素を削除し、新要素を `min+1` で追加  

#### ● 入力例：
```python
data = [1, 2, 1, 3, 1, 2, 1, 4, 5, 1]
k = 3
```
#### ● 処理結果：
```python
{1: 5, 4: 2, 5: 3}
```

#### ● 特徴：
- 常に最小要素のみを削除することで、頻出要素が長く保持されやすい。
- Δを使わず、出力された頻度も比較的信頼できる。
- 実装が最もシンプルで、実用性が非常に高い。

---

## 3. アルゴリズムが適用できる実際的なアプリケーション例

以下のような分野でMisra-Griesは活用できます：

- ✅ Webサーバのアクセスログ解析：頻繁にアクセスされるIPやURLの検出
- ✅ SNSやチャットにおけるホットワード検出（Twitterトレンドなど）
- ✅ センサーデータのフィルタリングや異常検知
- ✅ ネットワークパケットのモニタリングによるDoS攻撃の兆候検出
- ✅ IoTデバイス上での省メモリ頻度分析（エッジ側の処理）

### ● 自分の研究における応用例：

私の卒業研究では、サッカー映像から得点確率（Expected Goals: xG）を推定するシステムを構築しており、大量の映像クリップの中から「特徴的なプレーパターン」や「頻出する攻撃構成」を自動的に抽出することができるかもしれません。

Misra-Griesアルゴリズムを使えば、数千〜数万の攻撃シーンの中から**頻出するプレーの種類**を高速かつ省メモリに検出でき、モデル設計や戦術分析に役立つと考えられる。

---

## 📁 対応ソースコード一覧

| ファイル名 | 内容 |
|------------|------|
| `algo1.py` | Misra-Gries v3.1 の実装（全体-1減算法） |
| `algo2.py` | Misra-Gries v3.2 の実装（Δと段階的削除） |
| `algo3.py` | Misra-Gries v3.3 の実装（最小置換法） |

---

以上。